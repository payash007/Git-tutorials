utility functions for verison 3